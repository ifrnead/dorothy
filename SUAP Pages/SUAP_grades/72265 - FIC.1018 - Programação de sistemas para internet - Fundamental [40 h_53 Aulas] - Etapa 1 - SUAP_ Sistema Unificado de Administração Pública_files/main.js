(function(){window.__admin_media_prefix__="/static/admin/";django=[];django.jQuery=jQuery;open_menu_item=function(menu_item_id){elem=jQuery("#menu-item-"+menu_item_id);elem.addClass("active");elem.parents("li").addClass("active").toggleClass("opened");elem.parents("ul,li").show();};mode_responsive=function(){if($(window).width()<940){$("body").addClass("hideSidebar");}};moduloAbas=function(aba){if(!jQuery(aba).hasClass("active")){jQuery(aba).parent().find("h4").removeClass("active");jQuery(aba).addClass("active");}};initMenu=function(){menu_hide_sidebar=function(){jQuery("nav > ul > li").removeClass("hint");jQuery("nav > ul > li").removeAttr("data-hint");};jQuery("nav li.has-child > a").click(function(e){e.preventDefault();if(jQuery("body").hasClass("hideSidebar")){menu_hide_sidebar();jQuery("body").removeClass("hideSidebar");}
$(this).parent("li").toggleClass("opened");$(this).next("ul").toggle();});if(jQuery("body").hasClass("hideSidebar")){jQuery(".toggleSidebar").find("span.fas").removeClass("fa-chevron-left").addClass("fa-chevron-right");}
jQuery(".toggleSidebar").click(function(e){e.preventDefault();if(jQuery("body").hasClass("hideSidebar")){jQuery("html, body").animate({scrollTop:"0px"},'slow');menu_hide_sidebar();jQuery("nav li.opened > ul").show("slow");$.get("/comum/expandir_menu/");jQuery(this).find("span.fas").removeClass("fa-chevron-right").addClass("fa-chevron-left");}else{jQuery("nav > ul > li").addClass("hint");jQuery("nav > ul > li").each(function(){var texto=jQuery(this).find("> a").text();jQuery(this).attr("data-hint",texto);if(!jQuery("body").hasClass("anonima")){$(this).find("ul").hide();}});$.get("/comum/retrair_menu/");jQuery(this).find("span.fas").removeClass("fa-chevron-left").addClass("fa-chevron-right");}
jQuery("body").toggleClass("hideSidebar");});};var popupUserTriggerAtual;var popupUserTrigger;hide_user_popup=function(popupUser){setTimeout(function(){popupUser.removeClass("active");},3000);};show_profile_user_popup=function(profileId,url){var popupUser=jQuery('.popup-user-container');if(popupUser.length==0||!popupUser.hasClass('active')){jQuery.ajax({url:url+profileId+"/",async:false,method:"GET",}).done(function(data){var popupUser=jQuery('.popup-user-container');popupUser.remove();jQuery('body').append(data);popupUser=jQuery('.popup-user-container');var position=popupUserTrigger.offset();position['top']=position['top']+23;popupUser.css(position);popupUser.toggleClass("active");if(popupUser.hasClass('active')){var direita=$(window).width()-(popupUser.offset().left+popupUser.width());if(direita<(popupUser.width()+50)){popupUser.addClass("popup-left");position['left']=position['left']-150;popupUser.css(position);}
setTimeout(function(){var isHovered=jQuery('.popup-user-container:hover').length>0;if(!isHovered){hide_user_popup(popupUser);}},1000);}
popupUser.hover(function(){},function(){hide_user_popup(popupUser);});});}};String.prototype.removeAccents=function(){return this.replace(/[áàãâä]/gi,"a").replace(/[éè¨ê]/gi,"e").replace(/[íìïî]/gi,"i").replace(/[óòöôõ]/gi,"o").replace(/[úùüû]/gi,"u").replace(/[ç]/gi,"c").replace(/[ñ]/gi,"n").replace(/[^a-zA-Z0-9]/g," ");};__treeListFilter=function(input_text,list_name){var list=jQuery(list_name);var new_list=list.clone().appendTo(list.parent());new_list.children().find('*').show();new_list.find('li.has-child').addClass("opened");new_list.attr('id','_menu_list_expanded');new_list.removeClass('_main_menu');new_list.hide();var input=jQuery(input_text);var keyTimeout;var lastFilter='';function filterList(ulObject,filterValue){if(!ulObject.is('ul')&&!ulObject.is('ol')){return false;}
var children=ulObject.children();var result=false;for(var i=0;i<children.length;i++){var liObject=jQuery(children[i]);if(liObject.is('li')){var display=false;if(liObject.children().length>0){for(var j=0;j<liObject.children().length;j++){var subDisplay=filterList(jQuery(liObject.children()[j]),filterValue);display=display||subDisplay;}}
if(!display){var text=liObject.text().removeAccents();display=text.toLowerCase().indexOf(filterValue.removeAccents())>=0;if(display){liObject.addClass('__show-children__');}}
liObject.css('display',display?'block':'none');result=result||display;}}
ulObject.find('.__show-children__').find('*').show();return result;}
input.on('change search',function(){var filter=input.val().toLowerCase();if(filter!==''){list.hide();new_list.show();new_list.find('*').removeClass('__show-children__');}else{list.show();new_list.hide();}
filterList(new_list,filter);return false;}).keydown(function(){clearTimeout(keyTimeout);keyTimeout=setTimeout(function(){if(input.val()===lastFilter)return;lastFilter=input.val();input.change();},0);});return this;};submeter_form=function(campo){$('#'+campo.id).parents('form').submit();};initAll=function(context){if(!context)var context="body";$(document).ready(function(){__treeListFilter('#__filterinput__','aside nav > ul');});mode_responsive();jQuery(context).find(".action-bar .has-child > a").click(function(){jQuery(this).next("ul").toggle();return false;});jQuery(context).find(".action-bar .has-child ul").hover(function(){},function(){jQuery(this).hide("fast");});var offset=300,offset_opacity=1200,scroll_top_duration=700,$back_to_top=jQuery(context).find('.go-to-bottom');jQuery(window).scroll(function(){($(this).scrollTop()>offset)?$back_to_top.addClass('cd-is-visible'):$back_to_top.removeClass('cd-is-visible cd-fade-out');if($(this).scrollTop()>offset_opacity){$back_to_top.addClass('cd-fade-out');}
if($(this).scrollTop()>=jQuery(document).height()-jQuery(window).height()){$back_to_top.removeClass('cd-is-visible cd-fade-out');}});$back_to_top.on('click',function(event){event.preventDefault();jQuery('body,html').animate({scrollTop:jQuery(document).height()+jQuery(window).height(),},scroll_top_duration);});jQuery(context).find("label.required, .required label").attr("title","Preenchimento obrigatório");jQuery(context).find(".box > h3").click(function(){jQuery(this).parent().find("> div").animate({height:'toggle'});jQuery(this).parent().toggleClass("collapsed");var atributo=jQuery(this).attr("title");if(atributo=="Mostrar informações"){jQuery(this).attr("title","Esconder informações");}else{jQuery(this).attr("title","Mostrar informações");}
return false;});jQuery(context).find(".action-print a").click(function(){print();return false;});jQuery(context).find("#topodapagina").click(function(){jQuery('html, body').animate({scrollTop:0},'slow');});jQuery(context).find(".ancoras:not(.no-action) a").click(function(e){var link=jQuery(this).attr("href");var destino=jQuery(link).offset().top;jQuery(link).find("> .box").removeClass("hide");jQuery("html, body").animate({scrollTop:destino},'slow');e.stopPropagation();e.preventDefault();});jQuery(context).find(".progress p").each(function(){var texto=jQuery(this).text();var porcentagem=texto.indexOf("%");if(porcentagem==-1){var split=texto.split('/');texto=parseInt(split[0]*100/split[1])+"%";}
jQuery(this).css("width",texto);jQuery(this).parent().attr("data-progress",texto);});jQuery(context).find(".confirm, .danger, .icon-delete").not(".no-confirm, .ajax").not("[type='submit']").click(function(){return confirm(jQuery(this).attr("data-confirm")||"Tem certeza que deseja continuar?");});jQuery(context).find('#delete_form').on('keyup keypress',function(e){var keyCode=e.keyCode||e.which;if(keyCode===13){e.preventDefault();return false;}});jQuery(context).find(".disable_on_click").click(function(){jQuery(this).attr("disabled","disabled").prepend('<span class="fas fa-spinner fa-pulse" aria-hidden="true"></span> ');window.location=jQuery(this).data("href");});jQuery(context).find(".voltar").click(function(){window.history.back();});jQuery(context).find("#menu-device a").click(function(){jQuery(context).find('nav > ul').toggle();});jQuery(context).find(".popup-user-trigger").click(function(e){popupUserTrigger=jQuery(this);var profileId=popupUserTrigger.data("user-id");var popupUser=jQuery('.popup-user-container');var estahAtivo=popupUser.length>0&&popupUser.hasClass('active');if(estahAtivo){popupUser.remove();if(JSON.stringify(popupUserTriggerAtual)!=JSON.stringify(popupUserTrigger)){show_profile_user_popup(profileId,"/djtools/user_info/");}}else{show_profile_user_popup(profileId,"/djtools/user_info/");}
popupUserTriggerAtual=popupUserTrigger;e.preventDefault();});jQuery(context).find(".popup-profile-trigger").click(function(e){popupUserTrigger=jQuery(this);var profileId=popupUserTrigger.data("profile-id");var popupUser=jQuery('.popup-user-container');var estahAtivo=popupUser.length>0&&popupUser.hasClass('active');if(estahAtivo){popupUser.remove();if(JSON.stringify(popupUserTriggerAtual)!=JSON.stringify(popupUserTrigger)){show_profile_user_popup(profileId,"/djtools/profile_info/");}}else{show_profile_user_popup(profileId,"/djtools/profile_info/");}
popupUserTriggerAtual=popupUserTrigger;e.preventDefault();});function AtualizarContadorNotificacoesNaoLidas(operacao){var elemento=jQuery("header .notifications .counter"),contador=elemento.text();if(contador!=="99+"){if(operacao==="+"){if(elemento.length){console.log(Number(contador));elemento.text(Number(contador)+1);}else{jQuery("header .notifications > a").prepend("<span class='counter'>1</span>");}}else{if(contador==1){elemento.remove();}else{elemento.text(Number(contador)-1);}}}}
function AtualizarLeituraNotificacoes(obj,position){var botao=obj,id=obj.data("notificacao"),lida=obj.data("lida"),icone=obj.parent().parent().parent().parent().find("td.field-lida img"),artigo=obj.parent().parent().parent().parent().parent();if(lida==="True"){$.ajax("/comum/desmarcar_como_lida/"+id+"/").done(function(result){botao.data("lida","False");botao.html("Marcar como Lida");if(icone){icone.attr("src","/static/admin/img/icon-no.svg");icone.attr("alt","False");}
if(artigo){artigo.addClass("non-read");}
AtualizarContadorNotificacoesNaoLidas("+");});}else{$.ajax("/comum/marcar_como_lida/"+id+"/").done(function(result){botao.data("lida","True");if(position==='popup'){botao.parent().parent().parent().remove();}else{botao.html("Desmarcar como Lida");if(icone){icone.attr("src","/static/admin/img/icon-yes.svg");icone.attr("alt","True");}
if(artigo){artigo.removeClass("non-read");}}
AtualizarContadorNotificacoesNaoLidas("-");});}}
function ExibirNotificacoesNaoLidas(){$.ajax("/comum/notificacoes_nao_lidas/").done(function(result){$("#notifications-non-read").toggle().html(result.itens).promise().done(function(){$("#notifications-non-read .list-articles button.close-list").click(function(){$("#notifications-non-read").hide();});$("#notifications-non-read [data-notificacao]").on("click",function(e){AtualizarLeituraNotificacoes($(this),'popup');e.preventDefault();});});});}
jQuery(context).find(".notifications > a").click(function(){ExibirNotificacoesNaoLidas();});jQuery(context).find("[data-notificacao]").on("click",function(e){AtualizarLeituraNotificacoes($(this));e.preventDefault();});mapeamento_class_title={csv:"Exportar para CSV",pdf:"Exportar para PDF",editar16:"Editar",remover16:"Remover",detalhar16:"Detalhar",upload16:"Enviar Arquivo",cracha16:"Gerar crachá",carteira16:"Gerar carteira"};for(key in mapeamento_class_title){jQuery.each(jQuery("a."+key),function(index,value){elem=jQuery(value);if(elem.attr("title")==""){elem.attr("title",mapeamento_class_title[key]);}});}
jQuery(context).find(".action-bar .normalscreen").hide();jQuery(context).find(".action-bar .fullscreen").click(function(){jQuery(this).hide();jQuery(context).find("aside, footer, h2").hide();jQuery(context).find(".action-bar .normalscreen").show();jQuery(context).find("main").addClass("fullscreen");});jQuery(context).find(".action-bar .normalscreen").click(function(){jQuery(this).hide();jQuery(context).find("aside, footer, h2").show();jQuery(context).find(".action-bar .fullscreen").show();jQuery(context).find("main").removeClass("fullscreen");});jQuery(context).find(".selector-chosen .selector-filter img").attr("src","/static/comum/img/selector-choosen.png");jQuery(context).find(".modulo-abas h4").click(function(){moduloAbas(this);});jQuery(context).find(".action-bar .has-child").find("ul").each(function(){if(!jQuery(this).has("li").length){jQuery(this).parent().hide();}});$('.masterTooltip').hover(function(){var title=$(this).attr('title');$(this).data('tipText',title).removeAttr('title');$('<p class="tooltip"></p>').text(title).appendTo('body').fadeIn('slow');},function(){$(this).attr('title',$(this).data('tipText'));$('.tooltip').remove();}).mousemove(function(e){var mousex=e.pageX+20;var mousey=e.pageY+10;$('.tooltip').css({top:mousey,left:mousex})});};input_submit_on_click=function(){$("input[type=submit]:not(.dontdisable)").on("click",function(){var elem=$(this);var form=$(this.form);if(typeof form[0].checkValidity==='function'){if(form[0].checkValidity()){elem.parent().find("input[type=submit]").attr("disabled","disabled");elem.val("Aguarde...");}}else{elem.parent().find("input[type=submit]").attr("disabled","disabled");elem.val("Aguarde...");}
if(elem.attr("name")){elem.parent().append('<input type="hidden" name="'+elem.attr("name")+'" value="'+elem.val()+'" />');}
form.find(".selector-chosen select[multiple] option").attr("selected","selected");form.submit();});};jQuery.expr[":"].icontains=jQuery.expr.createPseudo(function(arg){return function(elem){return jQuery(elem).text().toUpperCase().indexOf(arg.toUpperCase())>=0;};});initCepWidget=function(widget,estado,cidade,bairro,logradouro){estado=estado||'select[name=estado]';cidade=cidade||'select[name=cidade]';bairro=bairro||'input[name=bairro]';logradouro=logradouro||'input[name=logradouro]';function setupWidget(){$(widget).blur(function(){var cep=$(this).val().replace('-','').replace('.','').trim();if(cep){var fieldset=$(this).closest('fieldset');$.get("/djtools/consultar_cep/"+cep+"/",function(data){if(data){console.log(data);var dados=JSON.parse(data);fieldset.find(estado).val(dados.estado_info.codigo_ibge).trigger('change');fieldset.find(cidade).val(dados.cidade_info.codigo_ibge).trigger('change');fieldset.find(cidade).append("<option value='"+dados.cidade_info.codigo_ibge+"' selected>"+(dados.cidade+"/"+dados.estado)+"</option>").val(dados.cidade_info.codigo_ibge).trigger('change.select2');fieldset.find(bairro).val(dados.bairro);fieldset.find(logradouro).val(dados.logradouro);}});}});}
setTimeout(setupWidget,3000);}}).call(this);